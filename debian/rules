#!/usr/bin/make -f

ifneq (,$(findstring parallel=,$(DEB_BUILD_OPTIONS)))
	NCPUS = $(patsubst parallel=%,%,$(filter parallel=%,$(DEB_BUILD_OPTIONS)))
else
	NCPUS := $(shell getconf _NPROCESSORS_ONLN 2>/dev/null || echo 1)
	ifeq ($(NCPUS),-1)
		NCPUS:=1
	endif
	ifeq ($(NCPUS),0)
		NCPUS:=1
	endif
endif


%:
	dh $@ --with quilt

override_dh_auto_build:
	$(MAKE) -j $(NCPUS) CONFIG=release
	
override_dh_auto_install:
	$(MAKE) install CONFIG=release \
	DESTDIR=$(CURDIR)/debian/openfx-arena-natron
	
override_dh_auto_install:
	$(MAKE) install CONFIG=release \
	DESTDIR=$(CURDIR)/debian/openfx-arena-natron
	
override_dh_clean:
	$(MAKE) clean CONFIG=release
	
	dh_clean
